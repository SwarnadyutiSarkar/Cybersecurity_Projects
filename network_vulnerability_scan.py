import nmap

def scan_network(target):
    nm = nmap.PortScanner()

    print(f"[*] Scanning {target} for open ports...")
    nm.scan(target, '1-1024')

    open_ports = []

    for host in nm.all_hosts():
        for proto in nm[host].all_protocols():
            lport = nm[host][proto].keys()
            for port in lport:
                if nm[host][proto][port]['state'] == 'open':
                    open_ports.append((host, port, nm[host][proto][port]['name']))

    if not open_ports:
        print("[*] No open ports found.")
        return

    print("\n[*] Open ports:")
    for host, port, name in open_ports:
        print(f"Host: {host}, Port: {port}, Service: {name}")

    print("\n[*] Performing vulnerability scan...")
    nm.scan(target, '1-1024', arguments='-sV --script=vuln')

    vulnerabilities = []

    for host in nm.all_hosts():
        for proto in nm[host].all_protocols():
            lport = nm[host][proto].keys()
            for port in lport:
                if 'script' in nm[host][proto][port]:
                    script = nm[host][proto][port]['script']
                    if 'vuln' in script:
                        vulnerabilities.append((host, port, script['vuln']))

    if not vulnerabilities:
        print("[*] No vulnerabilities found.")
        return

    print("\n[*] Vulnerabilities:")
    for host, port, vuln in vulnerabilities:
        print(f"Host: {host}, Port: {port}, Vulnerability: {vuln}")

if __name__ == "__main__":
    target = input("Enter the target IP address or range (e.g., 192.168.1.0/24): ")
    scan_network(target)
